<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</title>
    <style>
      body {
        text-align: center;
        font-family: "Tajawal", sans-serif;
        color: white;
        background-color: #111;
        margin: 0;
        padding: 0;
      }

      header {
        background: rgba(0, 0, 0, 0.8);
        padding: 15px;
        text-align: center;
        width: 100%;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1000;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
      }

      header h1 {
        flex-grow: 1;
        font-size: 24px;
      }

      .back-button {
        background: #0077ff;
        color: white;
        padding: 10px 15px;
        border: none;
        cursor: pointer;
        border-radius: 8px;
        font-size: 14px;
        transition: 0.3s;
      }

      .back-button:hover {
        background: #0077ff;
      }

      /* ğŸ”¹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ù…Ù„Ø© */
      select {
        padding: 8px;
        border-radius: 5px;
        font-size: 14px;
        background: #333;
        color: white;
        border: none;
        cursor: pointer;
      }

      .cart-container {
        margin-top: 80px;
        padding: 20px;
      }

      .cart-item {
        background: rgba(255, 255, 255, 0.1);
        margin: 10px auto;
        padding: 15px;
        border-radius: 10px;
        width: 50%;
        text-align: center;
        box-shadow: 0 5px 10px rgba(255, 255, 255, 0.2);
      }

      .cart-item p {
        font-size: 18px;
        color: #9b59b6;
      }

      .remove-btn {
        background: #0077ff;
        color: white;
        padding: 8px;
        border: none;
        cursor: pointer;
        border-radius: 8px;
        margin-top: 10px;
        transition: 0.3s;
      }

      .remove-btn:hover {
        background: #c0392b;
      }

      .clear-cart {
        background: #0077ff;
        color: white;
        padding: 10px 15px;
        border: none;
        cursor: pointer;
        border-radius: 8px;
        font-size: 16px;
        margin-top: 20px;
        transition: 0.3s;
      }

      .clear-cart:hover {
        background: #e84118;
      }

      /* ğŸ”¹ Ø²Ø± Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± PayPal */
      .paypal-button {
        background: #0070ba;
        color: white;
        padding: 12px 20px;
        border: none;
        cursor: pointer;
        border-radius: 8px;
        font-size: 16px;
        margin-top: 15px;
        transition: 0.3s;
        display: none; /* Ù…Ø®ÙÙŠ Ø­ØªÙ‰ ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ø³Ù„Ø© */
      }

      .paypal-button:hover {
        background: #005ea6;
      }
    </style>
  </head>
  <body>
    <header>
      <button class="back-button" onclick="goBack()">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
      <h1>ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h1>
      <select id="currency-selector" onchange="changeCurrency()">
        <option value="SAR">ğŸ‡¸ğŸ‡¦ SAR</option>
        <option value="USD">ğŸ‡ºğŸ‡¸ USD</option>
        <option value="EUR">ğŸ‡ªğŸ‡º EUR</option>
      </select>
    </header>

    <div class="cart-container" id="cart-container">
      <h2>ğŸ“¦ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©:</h2>
      <div id="cart-items"></div>
      <button class="clear-cart" onclick="clearCart()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©</button>
      <button
        class="paypal-button"
        id="paypal-button"
        onclick="payWithPayPal()"
      >
        ğŸ’³ Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± PayPal
      </button>
    </div>

    <script>
      function goBack() {
        window.location.href = "products.html"; // Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª
      }

      function loadCart() {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        let cartContainer = document.getElementById("cart-items");
        let paypalButton = document.getElementById("paypal-button");

        cartContainer.innerHTML = "";

        if (cart.length === 0) {
          cartContainer.innerHTML = "<p>ğŸ›‘ Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!</p>";
          paypalButton.style.display = "none"; // Ø¥Ø®ÙØ§Ø¡ Ø²Ø± Ø§Ù„Ø¯ÙØ¹
          return;
        }

        paypalButton.style.display = "inline-block"; // Ø¥Ø¸Ù‡Ø§Ø± Ø²Ø± Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ù…Ù†ØªØ¬Ø§Øª

        cart.forEach((item, index) => {
          let itemDiv = document.createElement("div");
          itemDiv.classList.add("cart-item");
          itemDiv.innerHTML = `
                    <p>ğŸ›ï¸ ${item.name} - ğŸ’° <span class="price" data-original="${item.price}">${item.price}</span> <span class="currency">SAR</span></p>
                    <button class="remove-btn" onclick="removeFromCart(${index})">âŒ Ø¥Ø²Ø§Ù„Ø©</button>
                `;
          cartContainer.appendChild(itemDiv);
        });

        updateCurrency();
      }

      function removeFromCart(index) {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        cart.splice(index, 1);
        localStorage.setItem("cart", JSON.stringify(cart));
        loadCart();
      }

      function clearCart() {
        localStorage.removeItem("cart");
        loadCart();
      }

      function changeCurrency() {
        let selectedCurrency = document.getElementById("currency-selector")
          .value;
        localStorage.setItem("selectedCurrency", selectedCurrency);
        updateCurrency();
      }

      function updateCurrency() {
        let selectedCurrency =
          localStorage.getItem("selectedCurrency") || "SAR";
        let exchangeRates = {
          SAR: 1,
          USD: 0.27,
          EUR: 0.25
        };

        let prices = document.querySelectorAll(".price");
        let currencyLabels = document.querySelectorAll(".currency");

        prices.forEach((price, index) => {
          let originalPrice = parseFloat(price.getAttribute("data-original"));
          let convertedPrice = (
            originalPrice * exchangeRates[selectedCurrency]
          ).toFixed(2);
          price.textContent = convertedPrice;
          currencyLabels[index].textContent = selectedCurrency;
        });

        document.getElementById("currency-selector").value = selectedCurrency;
      }

      function payWithPayPal() {
        let totalAmount = 0;
        let selectedCurrency =
          localStorage.getItem("selectedCurrency") || "SAR";
        let cart = JSON.parse(localStorage.getItem("cart")) || [];

        cart.forEach(item => {
          totalAmount += parseFloat(item.price);
        });

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ PayPal Ø¨ØµÙŠØºØ© URL
        let paypalUrl = `https://www.paypal.com/checkoutnow?amount=${totalAmount}&currency=${selectedCurrency}`;
        window.open(paypalUrl, "_blank");
      }

      document.addEventListener("DOMContentLoaded", function() {
        loadCart();
        updateCurrency();
      });
    </script>
  </body>
</html>
